<div class="resenas-container">
  <!-- Header dinámico -->
  <div class="resenas-header">
    <div class="header-content">
      <button *ngIf="mostrarBotonVolver" (click)="volverALugares()" class="btn-volver">
        <span>←</span>
        Volver a Lugares
      </button>
      <h1 class="resenas-title">{{ tituloPagina }}</h1>
      <p class="resenas-subtitle">{{ subtituloPagina }}</p>
    </div>
  </div>

  <!-- Botón flotante para agregar reseña -->
  <button
    *ngIf="!mostrarFormulario"
    (click)="mostrarFormulario = true"
    class="btn-flotante"
    aria-label="Agregar nueva reseña"
  >
    <span class="btn-flotante-icon">+</span>
    <span class="btn-flotante-text">Agregar Reseña</span>
  </button>

  <!-- Modal para formulario -->
  <div *ngIf="mostrarFormulario" class="modal-overlay" (click)="cerrarModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>
          {{ lugarId ? 'Agregar Reseña a ' + lugarNombre : 'Agregar Nueva Reseña' }}
        </h2>
        <button
          (click)="cerrarModal()"
          class="btn-cerrar-modal"
          type="button"
          aria-label="Cerrar formulario"
        >
          <span>×</span>
        </button>
      </div>
      
      <form (ngSubmit)="probarAgregarResena()" class="resena-form">
        <!-- Los mismos campos del formulario que ya tenías -->
        <div class="form-group">
          <label for="titulo" class="form-label">Título de la Reseña</label>
          <input
            type="text"
            id="titulo"
            name="titulo"
            [(ngModel)]="nuevaResena.titulo"
            required
            class="form-input"
            placeholder="Ej: Excelente experiencia en la playa"
            maxlength="60"
          >
          <div class="char-counter">{{ nuevaResena.titulo.length }}/60</div>
        </div>

        <div class="form-group">
          <label class="form-label">Calificación</label>
          <div class="estrellas-interactivas">
            <button
              type="button"
              *ngFor="let star of [1,2,3,4,5]; let i = index"
              (click)="nuevaResena.calificacion = i + 1"
              (mouseenter)="estrellasHover = i + 1"
              (mouseleave)="estrellasHover = 0"
              class="estrella-btn"
              [class.active]="(estrellasHover || nuevaResena.calificacion) > i"
              [class.selected]="nuevaResena.calificacion > i"
            >
              ★
            </button>
          </div>
          <div class="calificacion-texto">
            {{ getTextoCalificacion(nuevaResena.calificacion) }} ({{ nuevaResena.calificacion }}/5)
          </div>
        </div>

        <div class="form-group">
          <label for="contenido" class="form-label">Tu Experiencia</label>
          <textarea
            id="contenido"
            name="contenido"
            [(ngModel)]="nuevaResena.contenido"
            required
            rows="5"
            class="form-textarea"
            placeholder="Describe tu experiencia en este lugar... ¿Qué te gustó? ¿Qué mejorarías?"
            maxlength="500"
          ></textarea>
          <div class="char-counter">{{ nuevaResena.contenido.length }}/500</div>
        </div>

        <div class="form-actions">
          <button
            type="button"
            (click)="cerrarModal()"
            class="btn btn-secondary"
            [disabled]="cargando"
          >
            Cancelar
          </button>
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="cargando || !esFormularioValido()"
          >
            <span *ngIf="cargando" class="loading-spinner"></span>
            {{ cargando ? 'Publicando...' : 'Publicar Reseña' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- El resto del HTML se mantiene igual -->
  <!-- ... (estadísticas, lista de reseñas, etc.) -->
</div>