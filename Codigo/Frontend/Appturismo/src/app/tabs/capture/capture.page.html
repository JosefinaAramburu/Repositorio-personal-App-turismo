<ion-content>
  <!-- Formulario para agregar/editar lugar -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>
        <ion-icon name="{{ lugarEditando ? 'create-outline' : 'add-circle-outline' }}"></ion-icon>
        {{ lugarEditando ? 'Editar Lugar' : 'Agregar Nuevo Lugar' }}
      </ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <!-- Nombre -->
      <ion-item>
        <ion-label position="stacked">Nombre *</ion-label>
        <ion-input 
          [(ngModel)]="lugarEditando ? lugarEditando.nombre : nuevoLugar.nombre"
          placeholder="Ingresa el nombre del lugar"
          required>
        </ion-input>
      </ion-item>

      <!-- Categoría -->
      <ion-item>
        <ion-label position="stacked">Categoría *</ion-label>
        <ion-input 
          [(ngModel)]="lugarEditando ? lugarEditando.categoria : nuevoLugar.categoria"
          placeholder="Ej: Monumento, Restaurante, Parque"
          required>
        </ion-input>
      </ion-item>

      <!-- Descripción -->
      <ion-item>
        <ion-label position="stacked">Descripción</ion-label>
        <ion-textarea 
          [(ngModel)]="lugarEditando ? lugarEditando.descripcion : nuevoLugar.descripcion"
          placeholder="Describe el lugar..."
          rows="3">
        </ion-textarea>
      </ion-item>

      <!-- Horario -->
      <ion-item>
        <ion-label position="stacked">Horario</ion-label>
        <ion-input 
          [(ngModel)]="lugarEditando ? lugarEditando.horario : nuevoLugar.horario"
          placeholder="Ej: 9:00 - 18:00">
        </ion-input>
      </ion-item>

      <div class="buttons-container">
        <ion-button *ngIf="!lugarEditando" expand="block" (click)="crearLugar()" 
                   [disabled]="!nuevoLugar.nombre?.trim() || !nuevoLugar.categoria?.trim()"
                   color="primary">
          <ion-icon name="save-outline" slot="start"></ion-icon>
          Agregar Lugar
        </ion-button>
        
        <div *ngIf="lugarEditando" class="edit-buttons">
          <ion-button expand="block" (click)="guardarEdicion()" color="success">
            <ion-icon name="checkmark-outline" slot="start"></ion-icon>
            Guardar Cambios
          </ion-button>
          <ion-button expand="block" fill="outline" color="medium" (click)="cancelarEdicion()">
            <ion-icon name="close-outline" slot="start"></ion-icon>
            Cancelar
          </ion-button>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Lista de lugares -->
  <ion-card>
    <ion-card-header>
      <ion-card-title class="list-title">
        <ion-icon name="location-outline"></ion-icon>
        Mis Lugares ({{ lugares.length }})
      </ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <!-- Estado vacío -->
      <div *ngIf="lugares.length === 0" class="empty-state">
        <ion-icon name="map-outline" class="empty-icon"></ion-icon>
        <h3>No hay lugares guardados</h3>
        <p>Agrega tu primer lugar usando el formulario superior</p>
      </div>

      <!-- Lista de lugares -->
      <ion-list *ngIf="lugares.length > 0" class="places-list">
        <ion-item *ngFor="let lugar of lugares; trackBy: trackByLugar" class="place-item">
          <ion-label class="place-content">
            <h2 class="place-name">{{ lugar.nombre }}</h2>
            <div class="place-category">
              <ion-badge color="primary">{{ lugar.categoria }}</ion-badge>
            </div>
            <p class="place-description" *ngIf="lugar.descripcion">{{ lugar.descripcion }}</p>
            <div class="place-details">
              <div class="detail-item" *ngIf="lugar.horario">
                <ion-icon name="time-outline"></ion-icon>
                <span>{{ lugar.horario }}</span>
              </div>
            </div>
          </ion-label>
          <div class="action-buttons" slot="end">
            <ion-button fill="clear" color="warning" (click)="editarLugar(lugar)" size="small">
              <ion-icon name="create-outline"></ion-icon>
            </ion-button>
            <ion-button fill="clear" color="danger" (click)="eliminarLugar(lugar.id_lugares!)" size="small">
              <ion-icon name="trash-outline"></ion-icon>
            </ion-button>
          </div>
        </ion-item>
      </ion-list>

      <!-- Botón de recargar -->
      <ion-button expand="block" fill="outline" (click)="cargarLugares()" class="reload-button">
        <ion-icon name="refresh-outline" slot="start"></ion-icon>
        Recargar Lugares
      </ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>